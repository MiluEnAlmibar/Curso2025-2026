# SPARQL queries for Metro dataset (FR3–FR6 verification)
# Prefixes
PREFIX xsd:   <http://www.w3.org/2001/XMLSchema#>
PREFIX metro: <https://data.example.org/transport/bcn/metro/ontology#>
PREFIX ex:    <https://data.example.org/transport/bcn/metro/>

################################################################################
# Q0 — All lines (id, code, name, color) [FR1, FR6]
################################################################################
SELECT ?line ?lineId ?code ?name ?color
WHERE {
  ?line a metro:MetroLine ;
        metro:lineId ?lineId ;
        metro:lineName ?name .
  OPTIONAL { ?line metro:lineCode ?code }
  OPTIONAL { ?line metro:lineColor ?color }
}
ORDER BY ?lineId

################################################################################
# Q1 — Number of stations per line [FR5]
################################################################################
SELECT ?line ?lineId ?name (COUNT(DISTINCT ?st) AS ?stationCount)
WHERE {
  ?line a metro:MetroLine ;
        metro:lineId ?lineId ;
        metro:lineName ?name ;
        metro:hasStation ?st .
}
GROUP BY ?line ?lineId ?name
ORDER BY ?lineId

################################################################################
# Q2 — Stations of a given line (ordered by stationOrder) [FR3, FR5]
# Replace ___LINE_ID___ with the desired numeric id (e.g., 1, 2, 3, ...)
################################################################################
SELECT ?ord ?station ?stationId ?stationName
WHERE {
  ?line a metro:MetroLine ; metro:lineId ?lineId .
  FILTER(?lineId = ___LINE_ID___)
  ?sl a metro:StationLine ;
      metro:hasLine ?line ;
      metro:hasStation ?station ;
      metro:stationOrder ?ord .
  OPTIONAL { ?station metro:stationId ?stationId }
  OPTIONAL { ?station metro:stationName ?stationName }
}
ORDER BY xsd:integer(?ord)

################################################################################
# Q3 — Lines serving a given station [FR3]
# Replace ___STATION_ID___ with the desired numeric id
################################################################################
SELECT DISTINCT ?line ?lineId ?lineName
WHERE {
  ?station a metro:Station ; metro:stationId ?sid .
  FILTER(?sid = ___STATION_ID___)
  ?station metro:hasLine ?line .
  OPTIONAL { ?line metro:lineId ?lineId }
  OPTIONAL { ?line metro:lineName ?lineName }
}
ORDER BY ?lineId

################################################################################
# Q4 — Station details (name, geometry) [FR4]
# Replace ___STATION_ID___
################################################################################
SELECT ?station ?stationId ?stationName ?geometry
WHERE {
  ?station a metro:Station ; metro:stationId ?stationId .
  FILTER(?stationId = ___STATION_ID___)
  OPTIONAL { ?station metro:stationName ?stationName }
  OPTIONAL { ?station metro:hasGeometry ?geometry }
}

################################################################################
# Q5 — Line details (name, code, colors, origin/dest, geometry, station count) [FR6]
################################################################################
SELECT ?line ?lineId ?name ?code ?desc ?origin ?dest ?color ?textColor ?auxColor ?geometry (COUNT(DISTINCT ?st) AS ?stationCount)
WHERE {
  ?line a metro:MetroLine ;
        metro:lineId ?lineId .
  OPTIONAL { ?line metro:lineName ?name }
  OPTIONAL { ?line metro:lineCode ?code }
  OPTIONAL { ?line metro:lineDescription ?desc }
  OPTIONAL { ?line metro:originStation ?origin }
  OPTIONAL { ?line metro:destinationStation ?dest }
  OPTIONAL { ?line metro:lineColor ?color }
  OPTIONAL { ?line metro:textColor ?textColor }
  OPTIONAL { ?line metro:auxiliaryColor ?auxColor }
  OPTIONAL { ?line metro:hasGeometry ?geometry }
  OPTIONAL { ?line metro:hasStation ?st }
}
GROUP BY ?line ?lineId ?name ?code ?desc ?origin ?dest ?color ?textColor ?auxColor ?geometry
ORDER BY ?lineId

################################################################################
# Q6 — Station → Lines (compact list) [FR3]
################################################################################
SELECT ?stationId ?stationName (GROUP_CONCAT(DISTINCT STR(?lineId); separator=", ") AS ?lines)
WHERE {
  ?station a metro:Station .
  OPTIONAL { ?station metro:stationId ?stationId }
  OPTIONAL { ?station metro:stationName ?stationName }
  OPTIONAL {
    ?station metro:hasLine ?line .
    ?line metro:lineId ?lineId .
  }
}
GROUP BY ?stationId ?stationName
ORDER BY ?stationName
